<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>direcciones.py</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>direcciones.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <h3>Direcciones de archivos o datos hardcodeados utilizados para todos los demas scripts.</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>El archivo cuenta con direcciones de directorios donde guardar achivos especificos, encabezados
utilizados en los reportes y algunos datos utilizados para filtros de puertos y/o nodos.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <h1>variables globales</h1>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <h2>PRODUCCIÃ“N</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <h3>LOGS</h3>
<p><strong><em>Direcciones de logs y pid</em></strong></p>
<p><em>file_log</em> es la direccion utilizada por logger para guardar los logeos.</p>
<p>pid es donde el deamon de <em>orquestador_reportes</em> genera el PID del proceso.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">file_log</span><span class="o">=</span> <span class="s2">&quot;/var/log/reportes_zabbix/reportes.log&quot;</span>
<span class="n">pid</span> <span class="o">=</span> <span class="s2">&quot;/tmp/orquestador_reportes_zabbix.pid&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <h3>Archivos inventarios y procesados</h3>
<p><strong><em>Directorios y formatos de nombres para archivos TLK</em></strong></p>
<p>Direcciones y convecniones de nombres utilizadas por parseo en las funcioens 
referentes a los invetnarios de TLK.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p><strong><em>directorio origen y destino de archivos</em></strong>  </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p>directorio trabajo reporte tlk</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">path_files_tlk</span><span class="o">=</span><span class="s2">&quot;/var/lib/reportes-zabbix/reporte_tlk/&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>directorio trabajo reporte RBS</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">path_files_RBS</span><span class="o">=</span><span class="s2">&quot;/var/lib/reportes-zabbix/reporte_RBS/&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <p>nombre archivo origen  </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">file_tlk</span><span class="o">=</span><span class="s2">&quot;PLN245_procesado.TXT&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>nombre archivo destino</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">file_tlk_dst</span><span class="o">=</span><span class="s2">&quot;PLN245_parseado.csv&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>luego parseo renombro archivo original</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">file_tlk_old</span><span class="o">=</span><span class="s2">&quot;PLN245_procesado.old.TXT&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p>Concatenacion de nombres de archivos finales</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">archivo_tlk</span> <span class="o">=</span> <span class="n">path_files_tlk</span><span class="o">+</span><span class="n">file_tlk</span>
<span class="n">archivo_tlk_dst</span> <span class="o">=</span> <span class="n">path_files_tlk</span><span class="o">+</span><span class="n">file_tlk_dst</span>
<span class="n">archivo_tlk_viejo</span> <span class="o">=</span> <span class="n">path_files_tlk</span><span class="o">+</span><span class="n">file_tlk_old</span>

<span class="n">file_rbs_DCS</span><span class="o">=</span> <span class="s2">&quot;reportes_RBS.csv&quot;</span>
<span class="n">file_rbs_DCS_dst</span><span class="o">=</span> <span class="s2">&quot;RBS_parseado.csv&quot;</span>
<span class="n">file_rbs_DCS_old</span><span class="o">=</span> <span class="s2">&quot;reportes_RBS.old.csv&quot;</span>

<span class="n">archivo_rbs_DCS</span><span class="o">=</span> <span class="n">path_files_RBS</span><span class="o">+</span><span class="n">file_rbs_DCS</span>
<span class="n">archivo_rbs_DCS_dst</span><span class="o">=</span> <span class="n">path_files_RBS</span><span class="o">+</span><span class="n">file_rbs_DCS_dst</span>
<span class="n">archivo_rbs_DCS_old</span> <span class="o">=</span> <span class="n">path_files_RBS</span><span class="o">+</span><span class="n">file_rbs_DCS_old</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <h1>Inventarios Zabbix</h1>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <p><strong><em>Genera la direccion para encontrar el archivo crudo de zabbix diario</em></strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">crudozabbix</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p><strong>returns:</strong> string con la direccion del Merged-Trends crudo proveniente de zabbix-server de la fecha
en la que se ejecuto la funcion.<br />
<strong>rtype:</strong> str</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">crudozabbix</span> <span class="o">=</span> <span class="s2">&quot;/var/lib/reportes-zabbix/Merged-Trends-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;.ndjson&quot;</span>
    <span class="k">return</span> <span class="n">crudozabbix</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p><strong><em>Genera la direccion para guardar el archivo ONT.pickle luego de parsear crudos de zabbix</em></strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">archivo_pickle_ONT</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p><strong>returns:</strong> string con la direccion del ONT.pickle parseado desde el Merged-Trends proveniente de zabbix-server
de la fecha en la que se ejecuto la funcion.<br />
<strong>rtype:</strong> str</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">archivo_pickle_ONT</span> <span class="o">=</span> <span class="s2">&quot;/var/lib/reportes-zabbix/crudos/Merged-Trends-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;_ONT.pickle&quot;</span>
    <span class="k">return</span> <span class="n">archivo_pickle_ONT</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p><strong><em>Genera la direccion para guardar el archivo .pickle luego de parsear crudos de zabbix</em></strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">archivo_pickle_PON</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <p><strong>returns:</strong> string con la direccion del .pickle parseado desde el Merged-Trends proveniente de zabbix-server
de la fecha en la que se ejecuto la funcion.<br />
<strong>rtype:</strong> str</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">archivo_pickle_PON</span> <span class="o">=</span> <span class="s2">&quot;/var/lib/reportes-zabbix/crudos/Merged-Trends-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;.pickle&quot;</span>
    <span class="k">return</span> <span class="n">archivo_pickle_PON</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p><strong><em>Comandos para limpiar .pickle de ONT y PON con mas de 30 dias de antiguedad.</em></strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">limpiar_pickle_pon</span> <span class="o">=</span> <span class="s2">&quot;find /var/lib/reportes-zabbix/crudos/ -name </span><span class="se">\&quot;</span><span class="s2">Merged-Trends-*.pickle</span><span class="se">\&quot;</span><span class="s2"> -type f -mtime +30 -exec rm -f </span><span class="si">{}</span><span class="s2"> \;&quot;</span>
<span class="n">limpiar_pickle_ont</span> <span class="o">=</span> <span class="s2">&quot;find /var/lib/reportes-zabbix/crudos/ -name </span><span class="se">\&quot;</span><span class="s2">Merged-Trends-*_ONT.pickle</span><span class="se">\&quot;</span><span class="s2"> -type f -mtime +30 -exec rm -f </span><span class="si">{}</span><span class="s2"> \;&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <p><strong><em>Zabbix sender.</em></strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">pusheo_diario_ok</span> <span class="o">=</span> <span class="s2">&quot;zabbix_sender -z 10.0.0.101 -s Zabbix-Reportes -k scriptreportes  -o 0&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <h1>Reporte Zabbix</h1>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <p><strong><em>Genera la direccion para guardar el archivo reporte-semanal.xlsx</em></strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">excel_PON_semanal</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <p><strong>returns:</strong> string con la direccion para generar reporte-semanal.xlsx de la fecha en la que se ejecuto la funcion.<br />
:rtype: str</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">excel_PON_semanal</span> <span class="o">=</span> <span class="s2">&quot;/var/lib/reportes-zabbix/reportes_semanales/Reporte_Semanal_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;.xlsx&quot;</span>
    <span class="k">return</span> <span class="n">excel_PON_semanal</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <p><strong><em>Genera la direccion para guardar el archivo reporte-mensual.xlsx</em></strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">excel_PON_mensual</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <p><strong>returns:</strong> string con la direccion para generar reporte-mensual.xlsx de la fecha en la que se ejecuto la funcion.<br />
<strong>rtype:</strong> str</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">excel_PON_mensual</span> <span class="o">=</span> <span class="s2">&quot;/var/lib/reportes-zabbix/reportes_mensuales/Reporte_Mensual_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;.xlsx&quot;</span>
    <span class="k">return</span> <span class="n">excel_PON_mensual</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      <p><strong><em>Genera la direccion para guardar el archivo reporte-semanal_ONT.xlsx</em></strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">excel_ONT_semanal</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      <p><strong>returns:</strong> string con la direccion para generar reporte-semanal_ONT.xlsx de la fecha en la que se ejecuto la funcion.<br />
<strong>rtype:</strong> str</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">excel_ONT_semanal</span> <span class="o">=</span> <span class="s2">&quot;/var/lib/reportes-zabbix/reportes_semanales/Reporte_Semanal_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;_ONT.xlsx&quot;</span>
    <span class="k">return</span> <span class="n">excel_ONT_semanal</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      <p><strong><em>Genera la direccion para guardar el archivo reporte-mensual_ONT.xlsx</em></strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">excel_ONT_mensual</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      <p><strong>returns:</strong> string con la direccion para generar reporte-mensual_ONT.xlsx de la fecha en la que se ejecuto la funcion.<br />
<strong>rtype:</strong> str</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">excel_ONT_mensual</span> <span class="o">=</span> <span class="s2">&quot;/var/lib/reportes-zabbix/reportes_mensuales/Reporte_Mensual_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;_ONT.xlsx&quot;</span>
    <span class="k">return</span> <span class="n">excel_ONT_mensual</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      <p><strong><em>Clase que define el nombre de hoja junto con el encabezado correspondiente.</em></strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">DefiniciÃ³nEncabezados</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-32'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-32'>#</a>
      </div>
      <p>Une encabezados con nombre de hojas para generar los reportes semanalas y mensuales.</p>
<p>Solo cuenta con un <em>constructor</em>.</p>
<p><strong>param nombreHoja:</strong> Nombre de la hoja.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nombreHoja</span><span class="p">,</span> <span class="n">encabezados</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-33'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-33'>#</a>
      </div>
      <p><strong>type nombreHoja:</strong> str</p>
<p><strong>param encabezados:</strong> Lista de encabezados a insertar en conjunto con <em>nombreHoja</em>.<br />
<strong>type encabezados:</strong> list(str)</p>
<p><strong>returns:</strong> esta clase no tiene retornos.</p>
<p><strong><em>Lista de encabezados  a usar con DefiniciÃ³nEncabezados</em></strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">nombreHoja</span> <span class="o">=</span> <span class="n">nombreHoja</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encabezados</span> <span class="o">=</span> <span class="n">encabezados</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-34'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-34'>#</a>
      </div>
      <p>Los encabezados se separan por hojas de puertos PON, puertos de Uplink
o ONTs.</p>
<p>Esto se debe a que algunas hojas traen menos datos o directamente distintos (ONT).  </p>
<p><strong><em>Datos para la hoja de descripciones</em></strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">encabezados_PON_PON</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A1&quot;</span><span class="p">:</span><span class="s2">&quot;Modelo Nodo&quot;</span><span class="p">,</span><span class="s2">&quot;B1&quot;</span><span class="p">:</span><span class="s2">&quot;Nodo&quot;</span><span class="p">,</span><span class="s2">&quot;C1&quot;</span><span class="p">:</span><span class="s2">&quot;Slot/Puerto&quot;</span><span class="p">,</span><span class="s2">&quot;D1&quot;</span><span class="p">:</span><span class="s2">&quot;Hora Pico&quot;</span><span class="p">,</span><span class="s2">&quot;E1&quot;</span><span class="p">:</span><span class="s2">&quot;Fecha Pico&quot;</span><span class="p">,</span><span class="s2">&quot;F1&quot;</span><span class="p">:</span><span class="s2">&quot;Pico&quot;</span><span class="p">,</span><span class="s2">&quot;G1&quot;</span><span class="p">:</span><span class="s2">&quot;% Utilizacion&quot;</span><span class="p">,</span><span class="s2">&quot;H1&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Hora Pico&quot;</span><span class="p">,</span><span class="s2">&quot;I1&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Picos Diarios&quot;</span><span class="p">,</span><span class="s2">&quot;J1&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Horas Pico&quot;</span><span class="p">,</span><span class="s2">&quot;K1&quot;</span><span class="p">:</span><span class="s2">&quot;Total ONT&quot;</span><span class="p">,</span><span class="s2">&quot;L1&quot;</span><span class="p">:</span><span class="s2">&quot;Servicios Datos&quot;</span><span class="p">,</span><span class="s2">&quot;M1&quot;</span><span class="p">:</span><span class="s2">&quot;Servicios Empresariales&quot;</span><span class="p">,</span><span class="s2">&quot;N1&quot;</span><span class="p">:</span><span class="s2">&quot;Empresariales de RBS&quot;</span><span class="p">}</span>
<span class="n">encabezados_PON_uplink</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A1&quot;</span><span class="p">:</span><span class="s2">&quot;Modelo Nodo&quot;</span><span class="p">,</span><span class="s2">&quot;B1&quot;</span><span class="p">:</span><span class="s2">&quot;Nodo&quot;</span><span class="p">,</span><span class="s2">&quot;C1&quot;</span><span class="p">:</span><span class="s2">&quot;Slot/Puerto&quot;</span><span class="p">,</span><span class="s2">&quot;D1&quot;</span><span class="p">:</span><span class="s2">&quot;Hora Pico&quot;</span><span class="p">,</span><span class="s2">&quot;E1&quot;</span><span class="p">:</span><span class="s2">&quot;Fecha Pico&quot;</span><span class="p">,</span><span class="s2">&quot;F1&quot;</span><span class="p">:</span><span class="s2">&quot;Pico&quot;</span><span class="p">,</span><span class="s2">&quot;G1&quot;</span><span class="p">:</span><span class="s2">&quot;% Utilizacion&quot;</span><span class="p">,</span><span class="s2">&quot;H1&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Hora Pico&quot;</span><span class="p">,</span><span class="s2">&quot;I1&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Picos Diarios&quot;</span><span class="p">,</span><span class="s2">&quot;J1&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Horas Pico&quot;</span><span class="p">}</span>
<span class="n">encabezados_ONT</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A1&quot;</span><span class="p">:</span><span class="s2">&quot;Modelo Nodo&quot;</span><span class="p">,</span><span class="s2">&quot;B1&quot;</span><span class="p">:</span><span class="s2">&quot;Nodo&quot;</span><span class="p">,</span><span class="s2">&quot;C1&quot;</span><span class="p">:</span><span class="s2">&quot;Slot/Puerto/ONT&quot;</span><span class="p">,</span><span class="s2">&quot;D1&quot;</span><span class="p">:</span><span class="s2">&quot;Etiqueta&quot;</span><span class="p">,</span><span class="s2">&quot;E1&quot;</span><span class="p">:</span><span class="s2">&quot;Hora Pico&quot;</span><span class="p">,</span><span class="s2">&quot;F1&quot;</span><span class="p">:</span><span class="s2">&quot;Fecha Pico&quot;</span><span class="p">,</span><span class="s2">&quot;G1&quot;</span><span class="p">:</span><span class="s2">&quot;Pico&quot;</span><span class="p">,</span><span class="s2">&quot;H1&quot;</span><span class="p">:</span><span class="s2">&quot;% Utilizacion&quot;</span><span class="p">,</span><span class="s2">&quot;I1&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Hora Pico&quot;</span><span class="p">,</span><span class="s2">&quot;J1&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Picos Diarios&quot;</span><span class="p">,</span><span class="s2">&quot;K1&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Horas Pico&quot;</span><span class="p">}</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-35'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-35'>#</a>
      </div>
      <p>Usando los encabezados paso las descripciones de las columnas de las demas hojas.</p>
<p>Estos encabezados se escriben en la hoja descripciones. </p>
<p><strong><em>Defino los objetos para PON y ONT</em></strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">descripcion_PON</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A1&quot;</span><span class="p">:</span><span class="s2">&quot;Modelo Nodo: Modelo del nodo. C300, ISAM FX, MA5800, etc.&quot;</span><span class="p">,</span><span class="s2">&quot;A2&quot;</span><span class="p">:</span><span class="s2">&quot;Nodo: Nombre del nodo utilizado en listados de conectividad.&quot;</span><span class="p">,</span><span class="s2">&quot;A3&quot;</span><span class="p">:</span><span class="s2">&quot;Slot/Puerto: Numero de placa y puerto PON monitoreado.&quot;</span><span class="p">,</span><span class="s2">&quot;A4&quot;</span><span class="p">:</span><span class="s2">&quot;Hora Pico: Margen de hora en la que se genero el pico maximo de la semana o mes. Ej.: 20:00 significa entre 20:00 y 21:00.&quot;</span><span class="p">,</span><span class="s2">&quot;A5&quot;</span><span class="p">:</span><span class="s2">&quot;Fecha Pico: Fecha en la que se genero el pico maximo de la semana o mes.&quot;</span><span class="p">,</span><span class="s2">&quot;A6&quot;</span><span class="p">:</span><span class="s2">&quot;Pico: Medida de trafico mas alta de la semana o mes, muestreada cada 5 minutos.&quot;</span><span class="p">,</span><span class="s2">&quot;A7&quot;</span><span class="p">:</span><span class="s2">&quot;% Utilizacion: Porcentaje del ancho de banda del puerto que ocupo el pico.&quot;</span><span class="p">,</span><span class="s2">&quot;A8&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Hora: Trafico promedio de la hora en la que se genero el pico.&quot;</span><span class="p">,</span><span class="s2">&quot;A9&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Pico: Promedio de los picos diarios, de toda la semana o mes.&quot;</span><span class="p">,</span><span class="s2">&quot;A10&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Horas Pico: Promedio de las horas con mas trafico, por dia, de la semana o mes.&quot;</span><span class="p">,</span><span class="s2">&quot;A11&quot;</span><span class="p">:</span><span class="s2">&quot;Total ONT: Total de ONT que figuran en TLK al momento de generar el reporte.&quot;</span><span class="p">,</span><span class="s2">&quot;A12&quot;</span><span class="p">:</span><span class="s2">&quot;Servicio Datos: Total de servicio de datos que figuran en TLK al momento de generar el reporte.&quot;</span><span class="p">,</span><span class="s2">&quot;A13&quot;</span><span class="p">:</span><span class="s2">&quot;Servicios Empresariales: Total de servicios empresariales que figuran en TLK al momento de generar el reporte.&quot;</span><span class="p">,</span><span class="s2">&quot;A14&quot;</span><span class="p">:</span><span class="s2">&quot;Empresariales de RBS: Total de servicios empresariales que atienden Radio Bases, registrados en TLK al momento de generar el reporte.&quot;</span><span class="p">,</span><span class="s2">&quot;A16&quot;</span><span class="p">:</span><span class="s2">&quot;* Los datos pertenecientes a TLK solo figuran para puertos PON.&quot;</span><span class="p">}</span>
<span class="n">descripcion_ONT</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A1&quot;</span><span class="p">:</span><span class="s2">&quot;Modelo Nodo: Modelo del nodo. C300, ISAM FX, MA5800, etc.&quot;</span><span class="p">,</span><span class="s2">&quot;A2&quot;</span><span class="p">:</span><span class="s2">&quot;Nodo: Nombre del nodo utilizado en listados de conectividad.&quot;</span><span class="p">,</span><span class="s2">&quot;A3&quot;</span><span class="p">:</span><span class="s2">&quot;Slot/Puerto/ONT: Numero de placa, puerto PON y ONT monitoreada.&quot;</span><span class="p">,</span><span class="s2">&quot;A4&quot;</span><span class="p">:</span><span class="s2">&quot;Etiqueta: Etiqueta sobre el puerto logico que figura en NetNumen.&quot;</span><span class="p">,</span><span class="s2">&quot;A5&quot;</span><span class="p">:</span><span class="s2">&quot;Hora Pico: Margen de hora en la que se genero el pico maximo de la semana o mes. Ej.: 20:00 significa entre 20:00 y 21:00.&quot;</span><span class="p">,</span><span class="s2">&quot;A6&quot;</span><span class="p">:</span><span class="s2">&quot;Fecha Pico: Fecha en la que se genero el pico maximo de la semana o mes.&quot;</span><span class="p">,</span><span class="s2">&quot;A7&quot;</span><span class="p">:</span><span class="s2">&quot;Pico: Medida de trafico mas alta de la semana o mes, muestreada cada 5 minutos.&quot;</span><span class="p">,</span><span class="s2">&quot;A8&quot;</span><span class="p">:</span><span class="s2">&quot;% Utilizacion: Porcentaje del ancho de banda del puerto que ocupo el pico.&quot;</span><span class="p">,</span><span class="s2">&quot;A9&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Hora Pico: Trafico promedio de la hora en la que se genero el pico.&quot;</span><span class="p">,</span><span class="s2">&quot;A10&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Picos Diarios: Promedio de los picos diarios, de toda la semana o mes.&quot;</span><span class="p">,</span><span class="s2">&quot;A11&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Horas Pico: Promedio de las horas con mas trafico, por dia, de la semana o mes.&quot;</span><span class="p">}</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-36'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-36'>#</a>
      </div>
      <p>Paso los nombres de hojas junto con los encabezados que les corresponden.</p>
<p><strong><em>Datos para filtros en los parseos</em></strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">hojas_PON</span> <span class="o">=</span> <span class="p">[</span><span class="n">DefiniciÃ³nEncabezados</span><span class="p">(</span><span class="s2">&quot;Subida PON&quot;</span><span class="p">,</span> <span class="n">encabezados_PON_PON</span><span class="p">),</span> <span class="n">DefiniciÃ³nEncabezados</span><span class="p">(</span><span class="s2">&quot;Bajada PON&quot;</span><span class="p">,</span> <span class="n">encabezados_PON_PON</span><span class="p">),</span> <span class="n">DefiniciÃ³nEncabezados</span><span class="p">(</span><span class="s2">&quot;Subida Uplink&quot;</span><span class="p">,</span> <span class="n">encabezados_PON_uplink</span><span class="p">),</span> <span class="n">DefiniciÃ³nEncabezados</span><span class="p">(</span><span class="s2">&quot;Bajada Uplink&quot;</span><span class="p">,</span> <span class="n">encabezados_PON_uplink</span><span class="p">),</span><span class="n">DefiniciÃ³nEncabezados</span><span class="p">(</span><span class="s2">&quot;Descripciones&quot;</span><span class="p">,</span><span class="n">descripcion_PON</span><span class="p">)]</span>
<span class="n">hojas_ONT</span> <span class="o">=</span> <span class="p">[</span><span class="n">DefiniciÃ³nEncabezados</span><span class="p">(</span><span class="s2">&quot;Subida ONT&quot;</span><span class="p">,</span> <span class="n">encabezados_ONT</span><span class="p">),</span> <span class="n">DefiniciÃ³nEncabezados</span><span class="p">(</span><span class="s2">&quot;Bajada ONT&quot;</span><span class="p">,</span> <span class="n">encabezados_ONT</span><span class="p">),</span><span class="n">DefiniciÃ³nEncabezados</span><span class="p">(</span><span class="s2">&quot;Descripciones&quot;</span><span class="p">,</span><span class="n">descripcion_ONT</span><span class="p">)]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-37'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-37'>#</a>
      </div>
      <p><em>c300_19p:</em> Lista de nodos C300 de 19 pulgadas.</p>
<p><em>modelos_nodos:</em> Los distintos modelos de nodos GPON en produccion.</p>
<p>Los <em>puertos_uplik</em> definen los numeros de los puertos mencioandos por vendor o formato
(H por Huawei, 19 por C300 de 19 pulgadas).</p>
<p>Los <em>puertos_uplik_omitidos</em> filtran puertos que no queremos mostrar en los reportes (z por
C300 y z_19 por C300 de 19 pulgadas).</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-38'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-38'>#</a>
      </div>
      <h5>NODOS DE 19&rsquo;</h5>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">c300_19p</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;G-AZNAREZ-01Z&quot;</span><span class="p">,</span> <span class="s2">&quot;MARISCALA-01Z&quot;</span><span class="p">,</span> <span class="s2">&quot;A-ARENA-01Z&quot;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-39'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-39'>#</a>
      </div>
      <h5>MODELOS DE NODOS EN PRODUCCION</h5>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">modelos_nodos</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;MA5600T&quot;</span><span class="p">,</span><span class="s2">&quot;MA5800&quot;</span><span class="p">,</span><span class="s2">&quot;C300&quot;</span><span class="p">,</span><span class="s2">&quot;ISAM FX&quot;</span><span class="p">,</span><span class="s2">&quot;C600&quot;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-40'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-40'>#</a>
      </div>
      <h5>NUMERO DE LOS PUERTOS DE UPLINK</h5>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">puertos_uplink</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;21/1&quot;</span><span class="p">,</span><span class="s2">&quot;22/1&quot;</span><span class="p">]</span>

<span class="n">puertos_uplink_h</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;9/0&quot;</span><span class="p">,</span><span class="s2">&quot;10/0&quot;</span><span class="p">]</span>

<span class="n">puertos_uplink_19</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;19/1&quot;</span><span class="p">,</span><span class="s2">&quot;20/1&quot;</span><span class="p">]</span>

<span class="n">puertos_uplink_omitidos_z</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;21/2&quot;</span><span class="p">,</span><span class="s2">&quot;21/3&quot;</span><span class="p">,</span><span class="s2">&quot;21/4&quot;</span><span class="p">,</span><span class="s2">&quot;22/2&quot;</span><span class="p">,</span><span class="s2">&quot;22/3&quot;</span><span class="p">,</span><span class="s2">&quot;22/4&quot;</span><span class="p">,]</span>

<span class="n">puertos_uplink_omitidos_z_19</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;19/2&quot;</span><span class="p">,</span><span class="s2">&quot;19/3&quot;</span><span class="p">,</span><span class="s2">&quot;19/4&quot;</span><span class="p">,</span><span class="s2">&quot;20/2&quot;</span><span class="p">,</span><span class="s2">&quot;20/3&quot;</span><span class="p">,</span><span class="s2">&quot;20/4&quot;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-41'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-41'>#</a>
      </div>
      <h2>Datos Base Datos</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-42'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-42'>#</a>
      </div>
      <h3>variables para conexiÃ³n a la base de datos</h3>
<p><strong><em>Datos de DB usados por conector</em></strong></p>
<p>Datos que apuntan a la base de datos que queremos conector consulte.<br />
<em>host_DB:</em> Ip del BD Server.</p>
<p><em>user_DB:</em> user name con privilegios sobre la BD.</p>
<p><em>password_DB:</em> password del user name con privilegios sobre la BD.</p>
<p><em>database_DB:</em> Nombre de la base de datos a consultar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">host_DB</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span>
<span class="n">user_DB</span><span class="o">=</span><span class="s2">&quot;reportes&quot;</span>
<span class="n">password_DB</span><span class="o">=</span><span class="s2">&quot;antel2020&quot;</span>
<span class="n">database_DB</span><span class="o">=</span><span class="s2">&quot;reportes_zabbix&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-43'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-43'>#</a>
      </div>
      <h1>FIN PRODUCCIÃ“N</h1>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-44'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-44'>#</a>
      </div>
      <h1>Direcciones de Testing</h1>
<p><strong><em>Se repiten parametros que solo se utilizan para testear codigo.</em></strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">direccioens_testeo</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-45'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-45'>#</a>
      </div>
      <p>Estos apuntan a una BD de respaldo y pueden tener algunas direcciones cambiadas con respecto
a produccion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-46'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-46'>#</a>
      </div>
      <h2>DESARROLLO</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-47'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-47'>#</a>
      </div>
      <h4>LOGS</h4>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">file_log</span><span class="o">=</span> <span class="s2">&quot;reportes.log&quot;</span>
    <span class="n">pid</span> <span class="o">=</span> <span class="s2">&quot;/tmp/orquestador_reportes_zabbix.pid&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-48'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-48'>#</a>
      </div>
      <h3>Archivos inventarios y procesados</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-49'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-49'>#</a>
      </div>
      <p>directorio trabajo</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">path_files</span><span class="o">=</span> <span class="s2">&quot;./proyecto_zabbix/&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-50'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-50'>#</a>
      </div>
      <p>nombre archivo origen</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">file_tlk</span><span class="o">=</span><span class="s2">&quot;PLN245_procesado.TXT&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-51'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-51'>#</a>
      </div>
      <p>nombre archivo destino   </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">file_tlk_dst</span><span class="o">=</span><span class="s2">&quot;PLN245_parseado.csv&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-52'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-52'>#</a>
      </div>
      <p>luego parseo renombro archivo original     </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">file_tlk_old</span><span class="o">=</span><span class="s2">&quot;PLN245_procesado.old.TXT&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-53'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-53'>#</a>
      </div>
      <p>Concatenacion de nombres de archivos finales</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">archivo_tlk</span> <span class="o">=</span> <span class="n">path_files</span><span class="o">+</span><span class="n">file_tlk</span>
    <span class="n">archivo_tlk_dst</span> <span class="o">=</span> <span class="n">path_files</span><span class="o">+</span><span class="n">file_tlk_dst</span>
    <span class="n">archivo_tlk_viejo</span> <span class="o">=</span> <span class="n">path_files</span><span class="o">+</span><span class="n">file_tlk_old</span>

    <span class="n">file_rbs_DCS</span><span class="o">=</span> <span class="s2">&quot;reportes_RBS.csv&quot;</span>
    <span class="n">file_rbs_DCS_dst</span><span class="o">=</span> <span class="s2">&quot;RBS_parseado.csv&quot;</span>
    <span class="n">file_rbs_DCS_old</span><span class="o">=</span> <span class="s2">&quot;reportes_RBS.old.csv&quot;</span>

    <span class="n">archivo_rbs_DCS</span><span class="o">=</span> <span class="n">path_files</span><span class="o">+</span><span class="n">file_rbs_DCS</span>
    <span class="n">archivo_rbs_DCS_dst</span><span class="o">=</span> <span class="n">path_files</span><span class="o">+</span><span class="n">file_rbs_DCS_dst</span>
    <span class="n">archivo_rbs_DCS_old</span> <span class="o">=</span> <span class="n">path_files</span><span class="o">+</span><span class="n">file_rbs_DCS_old</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-54'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-54'>#</a>
      </div>
      <h3>Inventarios Zabbix</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">crudozabbix</span><span class="p">():</span>
        <span class="n">crudozabbix</span> <span class="o">=</span> <span class="s2">&quot;Merged-Trends-2020-12-07.ndjson&quot;</span>
        <span class="k">return</span> <span class="n">crudozabbix</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-55'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-55'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">archivo_pickle_ONT</span><span class="p">():</span>
        <span class="n">archivo_pickle_ONT</span> <span class="o">=</span> <span class="s2">&quot;Pickle_ONT&quot;</span>
        <span class="k">return</span> <span class="n">archivo_pickle_ONT</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-56'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-56'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">archivo_pickle_PON</span><span class="p">():</span>
        <span class="n">archivo_pickle_PON</span> <span class="o">=</span> <span class="s2">&quot;Pickle_PON&quot;</span>
        <span class="k">return</span> <span class="n">archivo_pickle_PON</span>

    <span class="n">limpiar_pickle_pon</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">limpiar_pickle_ont</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-57'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-57'>#</a>
      </div>
      <h3>Reporte Zabbix</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-58'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-58'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">excel_PON_semanal</span><span class="p">():</span>
        <span class="n">excel_PON_semanal</span> <span class="o">=</span> <span class="s2">&quot;Reporte PON Semanal.xlsx&quot;</span>
        <span class="k">return</span> <span class="n">excel_PON_semanal</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-59'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-59'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">excel_PON_mensual</span><span class="p">():</span>
        <span class="n">excel_PON_mensual</span> <span class="o">=</span> <span class="s2">&quot;Reporte PON Mensual.xlsx&quot;</span>
        <span class="k">return</span> <span class="n">excel_PON_mensual</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-60'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-60'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">excel_ONT_semanal</span><span class="p">():</span>
        <span class="n">excel_ONT_semanal</span> <span class="o">=</span> <span class="s2">&quot;Reporte ONT Semanal.xlsx&quot;</span>
        <span class="k">return</span> <span class="n">excel_ONT_semanal</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-61'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-61'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">excel_ONT_mensual</span><span class="p">():</span>
        <span class="n">excel_ONT_mensual</span> <span class="o">=</span> <span class="s2">&quot;Reporte ONT Mensual.xlsx&quot;</span>
        <span class="k">return</span> <span class="n">excel_ONT_mensual</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-62'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-62'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">class</span> <span class="nc">DefiniciÃ³nEncabezados</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-63'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-63'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nombreHoja</span><span class="p">,</span> <span class="n">encabezados</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nombreHoja</span> <span class="o">=</span> <span class="n">nombreHoja</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">encabezados</span> <span class="o">=</span> <span class="n">encabezados</span>

    <span class="n">encabezados_PON_PON</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A1&quot;</span><span class="p">:</span><span class="s2">&quot;Modelo Nodo&quot;</span><span class="p">,</span><span class="s2">&quot;B1&quot;</span><span class="p">:</span><span class="s2">&quot;Nodo&quot;</span><span class="p">,</span><span class="s2">&quot;C1&quot;</span><span class="p">:</span><span class="s2">&quot;Slot/Puerto&quot;</span><span class="p">,</span><span class="s2">&quot;D1&quot;</span><span class="p">:</span><span class="s2">&quot;Hora Pico&quot;</span><span class="p">,</span><span class="s2">&quot;E1&quot;</span><span class="p">:</span><span class="s2">&quot;Fecha Pico&quot;</span><span class="p">,</span><span class="s2">&quot;F1&quot;</span><span class="p">:</span><span class="s2">&quot;Pico&quot;</span><span class="p">,</span><span class="s2">&quot;G1&quot;</span><span class="p">:</span><span class="s2">&quot;% Utilizacion&quot;</span><span class="p">,</span><span class="s2">&quot;H1&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Hora Pico&quot;</span><span class="p">,</span><span class="s2">&quot;I1&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Picos Diarios&quot;</span><span class="p">,</span><span class="s2">&quot;J1&quot;</span><span class="p">:</span><span class="s2">&quot;Total ONT&quot;</span><span class="p">,</span><span class="s2">&quot;K1&quot;</span><span class="p">:</span><span class="s2">&quot;Servicios Datos&quot;</span><span class="p">,</span><span class="s2">&quot;L1&quot;</span><span class="p">:</span><span class="s2">&quot;Servicios Empresariales&quot;</span><span class="p">,</span><span class="s2">&quot;M1&quot;</span><span class="p">:</span><span class="s2">&quot;Empresariales de RBS&quot;</span><span class="p">}</span>
    <span class="n">encabezados_PON_uplink</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A1&quot;</span><span class="p">:</span><span class="s2">&quot;Modelo Nodo&quot;</span><span class="p">,</span><span class="s2">&quot;B1&quot;</span><span class="p">:</span><span class="s2">&quot;Nodo&quot;</span><span class="p">,</span><span class="s2">&quot;C1&quot;</span><span class="p">:</span><span class="s2">&quot;Slot/Puerto&quot;</span><span class="p">,</span><span class="s2">&quot;D1&quot;</span><span class="p">:</span><span class="s2">&quot;Hora Pico&quot;</span><span class="p">,</span><span class="s2">&quot;E1&quot;</span><span class="p">:</span><span class="s2">&quot;Fecha Pico&quot;</span><span class="p">,</span><span class="s2">&quot;F1&quot;</span><span class="p">:</span><span class="s2">&quot;Pico&quot;</span><span class="p">,</span><span class="s2">&quot;G1&quot;</span><span class="p">:</span><span class="s2">&quot;% Utilizacion&quot;</span><span class="p">,</span><span class="s2">&quot;H1&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Hora Pico&quot;</span><span class="p">,</span><span class="s2">&quot;I1&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Picos Diarios&quot;</span><span class="p">}</span>
    <span class="n">encabezados_ONT</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A1&quot;</span><span class="p">:</span><span class="s2">&quot;Modelo Nodo&quot;</span><span class="p">,</span><span class="s2">&quot;B1&quot;</span><span class="p">:</span><span class="s2">&quot;Nodo&quot;</span><span class="p">,</span><span class="s2">&quot;C1&quot;</span><span class="p">:</span><span class="s2">&quot;Slot/Puerto/ONT&quot;</span><span class="p">,</span><span class="s2">&quot;D1&quot;</span><span class="p">:</span><span class="s2">&quot;Etiqueta&quot;</span><span class="p">,</span><span class="s2">&quot;E1&quot;</span><span class="p">:</span><span class="s2">&quot;Hora Pico&quot;</span><span class="p">,</span><span class="s2">&quot;F1&quot;</span><span class="p">:</span><span class="s2">&quot;Fecha Pico&quot;</span><span class="p">,</span><span class="s2">&quot;G1&quot;</span><span class="p">:</span><span class="s2">&quot;Pico&quot;</span><span class="p">,</span><span class="s2">&quot;H1&quot;</span><span class="p">:</span><span class="s2">&quot;% Utilizacion&quot;</span><span class="p">,</span><span class="s2">&quot;I1&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Hora Pico&quot;</span><span class="p">,</span><span class="s2">&quot;J1&quot;</span><span class="p">:</span><span class="s2">&quot;Prom. Picos Diarios&quot;</span><span class="p">}</span>

    <span class="n">hojas_PON</span> <span class="o">=</span> <span class="p">[</span><span class="n">DefiniciÃ³nEncabezados</span><span class="p">(</span><span class="s2">&quot;Subida PON&quot;</span><span class="p">,</span> <span class="n">encabezados_PON_PON</span><span class="p">),</span> <span class="n">DefiniciÃ³nEncabezados</span><span class="p">(</span><span class="s2">&quot;Bajada PON&quot;</span><span class="p">,</span> <span class="n">encabezados_PON_PON</span><span class="p">),</span> <span class="n">DefiniciÃ³nEncabezados</span><span class="p">(</span><span class="s2">&quot;Subida Uplink&quot;</span><span class="p">,</span> <span class="n">encabezados_PON_uplink</span><span class="p">),</span> <span class="n">DefiniciÃ³nEncabezados</span><span class="p">(</span><span class="s2">&quot;Bajada Uplink&quot;</span><span class="p">,</span> <span class="n">encabezados_PON_uplink</span><span class="p">)]</span>
    <span class="n">hojas_ONT</span> <span class="o">=</span> <span class="p">[</span><span class="n">DefiniciÃ³nEncabezados</span><span class="p">(</span><span class="s2">&quot;Subida ONT&quot;</span><span class="p">,</span> <span class="n">encabezados_ONT</span><span class="p">),</span> <span class="n">DefiniciÃ³nEncabezados</span><span class="p">(</span><span class="s2">&quot;Bajada ONT&quot;</span><span class="p">,</span> <span class="n">encabezados_ONT</span><span class="p">)]</span>

    <span class="n">c300_19p</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;G-AZNAREZ-01Z&quot;</span><span class="p">,</span> <span class="s2">&quot;MARISCALA-01Z&quot;</span><span class="p">,</span> <span class="s2">&quot;A-ARENA-01Z&quot;</span><span class="p">]</span>

    <span class="n">modelos_nodos</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;MA5600T&quot;</span><span class="p">,</span><span class="s2">&quot;MA5800&quot;</span><span class="p">,</span><span class="s2">&quot;C300&quot;</span><span class="p">,</span><span class="s2">&quot;ISAM FX&quot;</span><span class="p">,</span><span class="s2">&quot;C600&quot;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-64'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-64'>#</a>
      </div>
      <h3>dato base datos</h3>
<p>variables para conexiÃ³n a la base de datos</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">host_DB</span><span class="o">=</span><span class="s2">&quot;192.168.211.4&quot;</span>
    <span class="n">user_DB</span><span class="o">=</span><span class="s2">&quot;reportes&quot;</span>
    <span class="n">password_DB</span><span class="o">=</span><span class="s2">&quot;antel2020&quot;</span>
    <span class="n">database_DB</span><span class="o">=</span><span class="s2">&quot;reportes_zabbix_test&quot;</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
